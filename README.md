# DAY 08 – Обучение без учителя
## Оглавление
1. [Глава I](#глава-i) \
    1.1. [Преамбула](#преамбула)
2. [Глава II](#глава-ii) \
    2.1. [Общая инструкция](#общая-инструкция)
3. [Глава III](#глава-iii) \
    3.1. [Цели](#цели)
4. [Глава IV](#глава-iv) \
    4.1. [Задание](#задание)
5. [Глава V](#глава-v) \
    5.1. [Сдача работы и проверка](#сдача-работы-и-проверка)

## Глава I
### Преамбула
Обучение без учителя (Unsupervised learning) — один из разделов машинного обучения. Изучает широкий класс задач 
обработки данных, в которых известны только описания множества объектов (обучающей выборки), и требуется обнаружить 
внутренние взаимосвязи, зависимости, закономерности, существующие между объектами.

Наиболее часто встречающимися задачами обучения без учителя являются задачи: кластеризация, поиск правил ассоциации, 
уменьшение размерности, задача визуализации и поиска аномалий в данных.

Задача кластеризации в машинном обучении заключается в разделении набора данных на группы (кластеры) таким образом, 
чтобы объекты внутри каждого кластера были схожи между собой, а объекты разных кластеров отличались друг от друга.

Для решения задачи кластеризации используются алгоритмы обучения без учителя, которые могут определить количество 
кластеров и их характеристики на основе структуры данных. Например, алгоритм [K-means](https://scikit-learn.org/stable/modules/clustering.html#k-means) 
разбивает данные на заранее заданное количество кластеров, а алгоритм [DBSCAN](https://scikit-learn.org/stable/modules/clustering.html#dbscan) 
определяет количество кластеров и их размеры на основе плотности объектов.

![clustering](misc/images/clustering_example.png)


Задача кластеризации может использоваться в различных областях, например, для сегментации клиентов по интересам или 
поведению, классификации текстовых документов по темам, анализа геномных данных и многих других. Задачей кластеризации 
мы сегодня и займемся.

## Глава II
### Общая инструкция

Методология Школы 21 может быть не похожа на тот образовательный опыт, который случался с тобой ранее. Её отличает высокий уровень автономии: у тебя есть задача, ты должен её выполнить. По большей части тебе нужно будет самому добывать знания для её решения. Второй важный момент — это peer-to-peer обучение. В образовательном процессе нет менторов и экспертов, перед которыми ты защищаешь свой результат. Ты это делаешь перед таким же учащимися, как и ты сам. У них есть чек-лист, который поможет им качественно выполнить приемку вашей работы.

Роль Школы 21 заключается в том, чтобы обеспечить через последовательность заданий и оптимальный уровень поддержки такую траекторию обучения, при которой ты не только освоишь hard skills, но и научишься самообучаться.

- Не доверяй слухам и предположениям о том, как должно быть оформлено ваше решение. Этот документ является единственным источником, к которому стоит обращаться по большинству вопросов;
- твое решение будет оцениваться другими учащимися;
- подлежат оцениванию только те файлы, которые ты выложил в GIT (ветка develop, папка src);
- в твоей папке не должно быть лишних файлов — только те, что были указаны в задании;
- не забывай, что у вас есть доступ к интернету и поисковым системам;
- обсуждение заданий можно вести и в Rocket.Chat;
- будь внимателен к примерам, указанным в этом документе — они могут иметь важные детали, которые не были оговорены другим способом;
- и да пребудет с тобой Сила!



## Глава III
### Цели
Американское туристическое агентство хочет разрекламировать свои услуги при помощи установки банеров. 
Оно обратилось к тебе, чтобы ты определил наилучшие точки установки. 

Эти банеры должны покрывать наиболее популярные заведения, а также быть недалеко от самих офисов агентства.
Для того чтобы определить наиболее популярные заведения воспользуемся данными крупнейшей социальной сети, 
основанной на локациях — [Foursquare](https://archive.org/details/201309_foursquare_dataset_umn).
## Глава IV
### Task 1
Загрузи [данные о посещениях заведений](https://files.sberdisk.ru/s/cW1tzZwkejcCvTP). В них содержится информации о регистрации пользователя в заведениях 
и геолокации этих заведений. Очисти данные от записей с пропусками. \
Выведи количество записей после очистки. 

### Task 2
Эти данные содержат информацию о заведениях со всего мира. С помощью геолокаций и библиотеки [Reverse Geocoder](https://github.com/thampiman/reverse-geocoder),
узнай страну для каждой геопозиции. \
Узнай **название** второй страны по количеству записей.

### Task 3
Нас будут интересовать только американские локации. Очисти данные от локаций, находящихся в других странах. 
Также чтобы сократить количество геолокаций оставь в выборке только 50 самых часто встречаемых заведений (venue). \
Выведи количество локаций, оставшихся после этих очисток.

### Task 4
Перейдем к задаче кластеризации. Воспользуйся алгоритмом [Mean Shift](https://scikit-learn.org/stable/modules/clustering.html#mean-shift)
для кластеризации локаций. Параметрами укажи `MeanShift(bandwidth=0.1, bin_seeding=True)`. `bandwidth=0.1` - это ширина ядра кластеризации.
Для средних широт США - это порядка 5-10 км. `bin_seeding=True` - для ускорения работы алгоритма. \
Выведи количество кластеров, которые у тебя получились в результате кластеризации.

### Task 5
Центры полученных кластеров - это потенциальные места установки банеров компании. Теперь хотелось бы найти те центры кластеров, 
которые наиболее близко находятся к офисам продаж компании. \
Загрузи [данные по координатам офисов компании](datasets/offices.csv). Для каждого офиса найди 5 самых ближайших к нему центров кластеров. 
(Пренебрежем тем, что Земля круглая и рассчитаем Евклидово расстояние).
У компании 11 офисов, значит у нас должно получится 55 мест установки банеров. \
Выведи координаты установки банера, который ближе всего находится к офису компании.

### Task 6
С помощью функции [scatter_mapbox](https://plotly.github.io/plotly.py-docs/generated/plotly.express.scatter_mapbox.html) 
отметь точки установки банеров. У тебя должна получится такая картинка.
![clustering](misc/images/task_6.png)\
Цветом точки укажи к какому офису будет относиться этот банер. 
>Цвет легенды может отличаться от референса

## Глава V
### Сдача работы и проверка

1. Сохрани решение в файле 08-assignment.ipynb
2. Загрузи изменения на Git в ветку develop.

💡 [Нажми здесь](https://forms.gle/42M9BgCqpMmSgA7b9) **чтобы отправить обратную связь по проекту**. 
